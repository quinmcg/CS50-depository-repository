<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <style>
        div#mp3_player{ width:800px; height:350px; background:#4d4d4d; padding:5px; margin:50px auto; }
        div#mp3_player > div > audio{  width:800px; background:#4d4d4d; float:left;  }
        div#mp3_player > canvas{ width:800px; height:300px; background:#4d4d4d; float:left; }
    </style>
    <link rel="stylesheet" type="text/css" href="./style.css">
    <script>
        var audio = new Audio();
        audio.src = 'gypsyheart.mp3';
        audio.controls = true;
        audio.loop = true;
        audio.autoplay = true;
        var canvas, ctx, source, context, analyser, fbc_array, bars, bar_x, bar_width, bar_height;
        window.addEventListener("load", initMp3Player, false);
        function initMp3Player(){
            document.getElementById('audio_box').appendChild(audio);
            context = new webkitAudioContext(); // AudioContext object instance
            analyser = context.createAnalyser(); // AnalyserNode method
            canvas = document.getElementById('analyser_render');
            ctx = canvas.getContext('2d');
            source = context.createMediaElementSource(audio);
            source.connect(analyser);
            analyser.connect(context.destination);
            frameLooper();
        }
        function frameLooper(){
            window.webkitRequestAnimationFrame(frameLooper);
            fbc_array = new Uint8Array(analyser.frequencyBinCount);
            analyser.getByteFrequencyData(fbc_array);
            ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear the canvas
            ctx.fillStyle = '#06e300'; // Color of the bars
            bars = 100;
            for (var i = 0; i < bars; i++) {
                bar_x = i * 3;
                bar_width = 2;
                bar_height = -(fbc_array[i] / 2);
                ctx.fillRect(bar_x, canvas.height, bar_width, bar_height);
            }
        }
    </script>
    <title>Quin's Audio Visualizer</title>
</head>
<body>
<ul class="nav">
    <div class="logo">
        VISUALIZER
    </div>
    <li> <a href="index.html">Home</a></li>
    <li> <a href="about.html">About</a></li>
    <li> <a href="sources.html">Sources</a></li>
    <li> <a href="contact.html">Contact</a></li>
</ul>
<div class="banner">
    <img class="banner-image" src="img/banner2.png"/>
</div>

<div id="mp3_player">
    <div id="audio_box"></div>
    <canvas id="analyser_render"></canvas>
</div>
</body>
</html>
